<div class="content-wrapper container-xxl p-0">
  <div class="content-body">
    <!-- content-header component -->
    <app-content-header [contentHeader]="contentHeader"></app-content-header>

    <!-- Horizontal Wizard -->
    <section class="horizontal-wizard">
      <div id="stepper1" class="bs-stepper horizontal-wizard-example">
        <div class="bs-stepper-header">
          <div class="step" data-target="#account-details">
            <button class="step-trigger">
              <span class="bs-stepper-box">1</span>
              <span class="bs-stepper-label">
                <span class="bs-stepper-title">Paso 1</span>
                <span class="bs-stepper-subtitle">Definición y Clasificación</span>
              </span>
            </button>
          </div>
          <div class="line"><i data-feather="chevron-right" class="font-medium-2"></i></div>
          <div class="step" data-target="#personal-info">
            <button class="step-trigger">
              <span class="bs-stepper-box">2</span>
              <span class="bs-stepper-label">
                <span class="bs-stepper-title">Paso 2</span>
                <span class="bs-stepper-subtitle">Tipo de Inforación<nav></nav></span>
              </span>
            </button>
          </div>
          <div class="line"><i data-feather="chevron-right" class="font-medium-2"></i></div>
          <div class="step" data-target="#social-links">
            <button class="step-trigger">
              <span class="bs-stepper-box">3</span>
              <span class="bs-stepper-label">
                <span class="bs-stepper-title">Paso 3</span>
                <span class="bs-stepper-subtitle">Configuraciones Generales</span>
              </span>
            </button>
          </div>
        </div>
        <div class="bs-stepper-content">
          <form (ngSubmit)="(HWForm.form.valid)" #HWForm="ngForm">
            <div id="account-details" class="content">
              <form #accountDetailsForm="ngForm">
                <div class="row">

                  <div class="form-group col-md-4">
                    <label class="form-label" for="http">HTTP / Puerto</label>
                    <ng-select [items]="http" [(ngModel)]="xAPIDB.puertohttp" #httpx="ngModel"
                      [class.error]="accountDetailsForm.submitted" id="http" name="http" required bindLabel="name"
                      bindId="id" bindValue="name" placeholder="Seleccione Puerto HTTP">
                    </ng-select>
                    <span *ngIf="accountDetailsForm.submitted && httpx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="httpx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>

                  <div class="form-group col-md-4">
                    <label class="form-label" for="https">HTTPS / Puerto</label>
                    <ng-select [items]="https" [(ngModel)]="xAPIDB.puertohttps" #httpsx="ngModel"
                      [class.error]="accountDetailsForm.submitted" id="https" name="https" required bindLabel="name"
                      bindId="id" bindValue="name" placeholder="Seleccione Puerto HTTPS">
                    </ng-select>
                    <span *ngIf="accountDetailsForm.submitted && httpsx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="httpsx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>


                  <div class="form-group col-md-4">
                    <label class="form-label" for="tipo">Tipo</label>
                    <ng-select [items]="tipo" [(ngModel)]="xAPIDB.tipo" #tipox="ngModel"
                      (ngModelChange)="onTipo($event)" [class.error]="accountDetailsForm.submitted" id="tipo"
                      name="tipo" required bindLabel="name" bindValue="id" placeholder="Seleccione Tipo"></ng-select>
                    <span *ngIf="accountDetailsForm.submitted && tipox.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="tipox.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>
                </div>

                <div class="row">
                  <div class="form-group col-md-6">
                    <label class="form-label" for="distribucion">Distribución</label>
                    <ng-select [items]="distribucion" [(ngModel)]="xAPIDB.distribucion" #distribucionx="ngModel"
                      [class.error]="accountDetailsForm.submitted" id="distribucion" name="distribucion" required
                      bindLabel="name" bindId="id" bindValue="id" placeholder="Seleccione Distribución"></ng-select>
                    <span *ngIf="accountDetailsForm.submitted && distribucionx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="distribucionx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>
                  <div class="form-group col-md-6">
                    <label class="form-label" for="aplicacion">Aplicación</label>
                    <ng-select [items]="ListaAplicaciones" [(ngModel)]="xAPIDB.aplicacion" #aplicacionx="ngModel"
                      [class.error]="accountDetailsForm.submitted" id="distribucion" name="distribucion" required
                      bindLabel="name" bindValue="nombre" placeholder="Seleccione Aplicación"></ng-select>
                    <span *ngIf="accountDetailsForm.submitted && aplicacionx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="aplicacionx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>

                </div>

                <div class="row">
                  <div class="form-group col-md-4">
                    <label class="form-label" for="funcion">Función</label>
                    <input required type="text" name="last-names" id="last-names" [(ngModel)]="xAPIDB.funcion"
                      #funcionx="ngModel" [class.error]="accountDetailsForm.submitted" id="funcion" name="funcion"
                      required class="form-control">
                    <span *ngIf="accountDetailsForm.submitted && funcionx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="funcionx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>
                  <div class="form-group col-md-2">
                    <label class="form-label" for="version">Versión</label>
                    <input [(ngModel)]="xAPIDB.version" [ngModelOptions]="{standalone: true}" [disabled]="true" required
                      type="text" name="last-namew" id="last-namew" class="form-control">
                  </div>
                  <div class="form-group col-md-6">
                    <label class="form-label" for="conexion">Conexión</label>
                    <ng-select [items]="drivers" [(ngModel)]="xAPIDB.driver" #driverx="ngModel"
                      [class.error]="accountDetailsForm.submitted" id="id" name="id" required bindLabel="name"
                      (ngModelChange)="selDataBase($event)" placeholder="Seleccione Conexión"></ng-select>
                    <span *ngIf="accountDetailsForm.submitted && driverx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="driverx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>
                </div>

                <div class="row">
                  <div class="form-group col-md-4">
                    <label class="form-label" for="categoria">Categoria</label>
                    <ng-select [items]="categoria" [(ngModel)]="xAPIDB.categoria" #categoriax="ngModel"
                      [class.error]="accountDetailsForm.submitted" id="categoria" name="categoria" required
                      bindLabel="name" bindId="id" bindValue="name" bindLabel="name" bindValue="id"
                      placeholder="Seleccione Categoria"></ng-select>
                    <span *ngIf="accountDetailsForm.submitted && categoriax.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="categoriax.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>
                  <div class="form-group col-md-4">
                    <label class="form-label" for="funcionalidad">Funcionalidad</label>
                    <ng-select [items]="funcionalidad" [(ngModel)]="xAPIDB.funcionalidad" #funcionalidadx="ngModel"
                      [class.error]="accountDetailsForm.submitted" id="funcionalidad" name="funcionalidad" required
                      bindLabel="name" bindId="id" bindValue="name" bindLabel="name" bindValue="id"
                      placeholder="Seleccione Funcionalidad"></ng-select>
                    <span *ngIf="accountDetailsForm.submitted && funcionalidadx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="funcionalidadx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>
                </div>

                <div class="row">
                  <div class="form-group col-md-12">
                    <label class="form-label" for="descripcion">Descripción</label>
                    <textarea [(ngModel)]="xAPIDB.descripcion" rows="7" #descripcionx="ngModel"
                      [class.error]="accountDetailsForm.submitted" id="descripcion" name="descripcion" required
                      type="text" name="last-namew" id="last-namew" class="form-control"></textarea>
                    <span *ngIf="accountDetailsForm.submitted && descripcionx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="descripcionx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>
                </div>



                <div class="d-flex justify-content-between">
                  <button (click)="horizontalWizardStepperPrevious()" class="btn btn-outline-secondary btn-prev"
                    disabled rippleEffect>
                    <i data-feather="arrow-left" class="align-middle mr-sm-25 mr-0"></i>
                    <span class="align-middle d-sm-inline-block d-none">Atras</span>
                  </button>
                  <button (click)="horizontalWizardStepperNext(accountDetailsForm)" type="submit"
                    class="btn btn-primary btn-next" rippleEffect>
                    <span class="align-middle d-sm-inline-block d-none">Siguiente</span>
                    <i data-feather="arrow-right" class="align-middle ml-sm-25 ml-0"></i>
                  </button>
                </div>
              </form>
            </div>
            <div id="personal-info" class="content">
              <form #personalInfoForm="ngForm">

                <div class="row">
                  <div class="form-group col-md-4">
                    <label class="form-label" for="metodo">Metodo</label>
                    <ng-select [items]="metodo" (ngModelChange)="onMetodo($event)" [(ngModel)]="xAPIDB.metodo"
                      [ngModelOptions]="{standalone: true}" bindLabel="name" bindValue="id"
                      placeholder="Seleccione Metodo"></ng-select>
                  </div>
                  <div class="form-group col-md-2">
                    <label class="form-label" for="relacional">Relacional</label>
                    <ng-select [items]="relacional" [(ngModel)]="xAPIDB.relacional" [ngModelOptions]="{standalone:true}"
                      bindLabel="name" bindId="id" bindValue="id" (ngModelChange)="clickRelacional(xAPIDB.relacional)"
                      placeholder="Seleccione Relacional"></ng-select>
                  </div>
                  <div class="form-group col-md-6">
                    <label class="form-label" for="coleccion">Colección en caso de ser NOSQL</label>
                    <input type="text" [(ngModel)]="xAPIDB.coleccion" [disabled]="DisabledNoSql == true"
                      [ngModelOptions]="{standalone: true}" class="form-control" placeholder="Coleccion">
                  </div>
                </div>

                <div class="row">
                  <div class="form-group col-md-4">
                    <label class="form-label" for="nombretabla">Nombre de la tabla</label>
                    <ng-select [items]="dataModulo" [(ngModel)]="tabla" [ngModelOptions]="{standalone:true}"
                      bindLabel="name" (ngModelChange)='selectEventModulo($event)'
                      placeholder="Seleccione Relacional"></ng-select>
                  </div>

                  <div class="form-group col-md-2">
                    <label class="form-label" for="criterio">Tipo de Criterio</label>
                    <ng-select [items]="lstDml" [(ngModel)]="xdml" [disabled]="DisabledTipoDato == true"
                      [ngModelOptions]="{standalone: true}" (ngModelChange)='onDml($event)' bindLabel="nombre"
                      bindValue="id" placeholder="Seleccione Tipo de dato"></ng-select>
                  </div>

                  <div class="form-group col-md-2">
                    <label class="form-label" for="funcion">Valor por defecto</label>
                    <input type="text" [(ngModel)]="defecto" [ngModelOptions]="{standalone: true}" class="form-control"
                      placeholder="Valor por defecto">
                  </div>

                  <div class="form-group col-md-4">
                    <label class="form-label" for="version">Condición</label>
                    <ng-select [items]="lstcondicion" [disabled]="xcondicion == true" [(ngModel)]="condicion"
                      [ngModelOptions]="{standalone: true}" bindLabel="name" bindId="id" bindValue="name"
                      placeholder="Seleccione Condición"></ng-select>
                  </div>

                </div>

                <div class="row">
                  <div class="form-group col-md-4">
                    <label class="form-label" for="campo">Nombre del campo</label>
                    <ng-select [items]="dataCampo" [(ngModel)]="campo" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindId="id" bindValue="name" placeholder="Seleccione Campo"></ng-select>
                  </div>


                  <div class="form-group col-md-3">
                    <label class="form-label" for="alias">Alias</label>
                    <input type="text" [(ngModel)]="alias" [ngModelOptions]="{standalone: true}" class="form-control"
                      placeholder="Alias">
                  </div>

                  <div class="form-group col-md-4">
                    <label class="form-label" for="tipodatox">Tipo de dato</label>
                    <ng-select [items]="lsttipodato" [(ngModel)]="tipodato" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindId="id" bindValue="id" placeholder="Seleccione Tipo de dato"></ng-select>
                  </div>
                  <div class="form-group col-md-1" style="margin-top: 24px;">
                    <button class="btn btn-success" (click)="agregarEntrada()">+</button>
                  </div>
                </div>

                <div class="row">
                  <div class="form-group col-md-12">
                    <label>Esquema de entrada:</label>
                    <div class="form-group text-justify">
                      <ngx-codemirror [ngModelOptions]="{standalone: true}" [(ngModel)]="xAPIDB.entradas"
                        (ngModelChange)="setEditorContent($event)" (click)="clickRefresh($event)" [options]="codeJson">
                      </ngx-codemirror>
                    </div>
                  </div>

                  <div class="form-group col-md-12">
                    <label>Consulta / SQL / NOSQL </label>
                    <div class="form-group text-justify">
                      <ngx-codemirror #codemirror aria-describedby="login-codigo" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="xAPIDB.query" (ngModelChange)="setEditorContent($event)"
                        (click)="clickRefresh($event)" tabindex="1" autofocus [options]="codeSQL">
                      </ngx-codemirror>
                    </div>
                  </div>

                </div>

                <div class="row">
                  <div class="form-group col-md-6">
                    <label class="form-label" for="parametros">Parametros</label>
                    <input type="text" class="form-control" placeholder="Parametros">
                  </div>

                  <div class="form-group col-md-6">
                    <label for="login-valor-retorno" class="form-label">Valor Retorno</label>
                    <ng-select [items]="retorn" bindLabel="descripcion" placeholder="Seleccione Valor Retorno"
                      bindId="id">
                    </ng-select>
                  </div>

                </div>



                <div class="row">
                  <div class="form-group col-md-6">
                    <label class="form-label" for="version">Funciones de la prueba</label>
                    <ng-select [items]="funciones" [(ngModel)]="funcionalidad" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindId="id" placeholder="Seleccione Funciones"></ng-select>
                  </div>


                  <div class="form-group col-md-6">
                    <label class="form-label" for="funcion">Agregar columna de la consulta</label>
                    <input type="text" [(ngModel)]="xAPIDB.consumidores" [ngModelOptions]="{standalone: true}"
                      class="form-control" placeholder="Agregar columna de la consulta">
                  </div>


                </div>


                <div class="d-flex justify-content-between">
                  <button type="button" (click)="horizontalWizardStepperPrevious()" class="btn btn-primary btn-prev"
                    rippleEffect>
                    <i data-feather="arrow-left" class="align-middle mr-sm-25 mr-0"></i>
                    <span class="align-middle d-sm-inline-block d-none">Atras</span>
                  </button>
                  <button (click)="horizontalWizardStepperNext(personalInfoForm)" class="btn btn-primary btn-next"
                    rippleEffect>
                    <span class="align-middle d-sm-inline-block d-none">Siguiente</span>
                    <i data-feather="arrow-right" class="align-middle ml-sm-25 ml-0"></i>
                  </button>
                </div>
              </form>
            </div>

            <div id="social-links" class="content">
              <form #socialLinkForm="ngForm">


                <div class="row">
                  <div class="form-group col-md-3">
                    <label class="form-label" for="consumidores">Consumidores</label>
                    <input type="number" [(ngModel)]="xAPIDB.consumidores" #consumidoresx="ngModel"
                      [class.error]="socialLinkForm.submitted" id="consumidores" name="consumidores" required
                      class="form-control" placeholder="Consumidores">
                    <span *ngIf="socialLinkForm.submitted && consumidoresx.invalid" class="invalid-form">
                      <small class="form-text text-danger" *ngIf="consumidoresx.errors.required">Este campo es
                        requerido!</small>
                    </span>
                  </div>
                  <div class="form-group col-md-3">
                    <label class="form-label" for="cache">Cache</label>
                    <ng-select [items]="cache" [(ngModel)]="xAPIDB.cache" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindValue="id" placeholder="Seleccione Cache"></ng-select>
                  </div>
                  <div class="form-group col-md-2">
                    <label class="form-label" for="logs">Logs</label>
                    <ng-select [items]="logs" [(ngModel)]="xAPIDB.logs" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindValue="id" placeholder="Seleccione Logs"></ng-select>
                  </div>
                  <div class="form-group col-md-2">
                    <label class="form-label" for="concurrente">Concurrente</label>
                    <ng-select [items]="concurrente" [(ngModel)]="xAPIDB.concurrencia"
                      [ngModelOptions]="{standalone: true}" bindLabel="name" bindValue="id"
                      placeholder="Seleccione Concurrente"></ng-select>
                  </div>
                  <div class="form-group col-md-2">
                    <label class="form-label" for="retorno">Retorno</label>
                    <ng-select [items]="retorno" [(ngModel)]="xAPIDB.retorna" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindValue="id" placeholder="Seleccione Retorno"></ng-select>
                  </div>
                </div>

                <div class="row">
                  <div class="form-group col-md-2">
                    <label class="form-label" for="tiempoduracion">Tiempo de Duracion</label>
                    <input type="number" [(ngModel)]="xAPIDB.tiempoduracion" [ngModelOptions]="{standalone: true}"
                      placeholder="Seleccione Tiempo" class="form-control">
                  </div>
                  <div class="form-group col-md-2">
                    <label class="form-label" for="tipoduracion">Tipo de Duración</label>
                    <ng-select [items]="duracion" [(ngModel)]="xAPIDB.tipoduracion"
                      [ngModelOptions]="{standalone: true}" bindLabel="name" bindValue="id"
                      placeholder="Seleccione Tipo Duración"></ng-select>
                  </div>

                  <div class="form-group col-md-2">
                    <label class="form-label" for="prioridad">Prioridad</label>
                    <ng-select [items]="prioridad" [(ngModel)]="xAPIDB.prioridad" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindValue="id" placeholder="Seleccione Prioridad"></ng-select>
                  </div>
                  <div class="form-group col-md-3">
                    <label class="form-label" for="entorno">Entorno</label>
                    <ng-select [items]="entorno" [(ngModel)]="xAPIDB.entorno" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindValue="id" placeholder="Seleccione Entorno"></ng-select>
                  </div>
                  <div class="form-group col-md-3">
                    <label class="form-label" for="Waf">Aplicar Waf</label>
                    <ng-select [items]="waf" [(ngModel)]="xAPIDB.accion" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindValue="id" placeholder="Seleccione Aplicar Waf"></ng-select>
                  </div>
                </div>

                <div class="row">
                  <div class="form-group col-md-3">
                    <label class="form-label" for="estatus">Estatus</label>
                    <ng-select [items]="estatus" [(ngModel)]="xAPIDB.estatus" [ngModelOptions]="{standalone: true}"
                      bindLabel="name" bindValue="id" placeholder="Seleccione Estatus"></ng-select>
                  </div>
                </div>

                <div class="row">
                  <div class="form-group col-md-12">
                    <label class="form-label" for="url">URL</label>
                    <input required type="text" name="last-namew" [disabled]="true" [placeholder]="ruta" id="last-namew"
                      class="form-control">
                  </div>
                </div>

                <div class="d-flex justify-content-between">
                  <button type="button" (click)="horizontalWizardStepperPrevious()" class="btn btn-primary btn-prev"
                    rippleEffect>
                    <i data-feather="arrow-left" class="align-middle mr-sm-25 mr-0"></i>
                    <span class="align-middle d-sm-inline-block d-none">Atras</span>
                  </button>
                  <button class="btn btn-success btn-submit" *ngIf="getURL == 'update-api'"
                    (click)="UpdateAPI(xAPIDB.funcion,xAPIDB.entorno)" rippleEffect>Actualizar</button>
                  <button class="btn btn-success btn-submit" *ngIf="getURL == 'register-api'" (click)="RegistrarAPI()"
                    rippleEffect>Guardar</button>
                </div>
              </form>
            </div>
          </form>
        </div>
      </div>
    </section>
    <!--/ Horizontal Wizard -->

  </div>
</div>